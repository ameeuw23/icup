{% extends "ICupPublicSiteBundle:Masters:standard.html.twig" %}
{% trans_default_domain "tournament" %}

{% import _self as formatter %}

{% macro club(teams, context) %}
    <table>
    {% for team in teams %}
        <tr>
        {% if team.matches > 0 %}
            <td class="winner_flag"><img src="{{ context.imagepath }}/flags/{{ context.countries[team.country].flag }}" alt="{{ team.country|trans({},'lang') }}" title="{{ team.country|trans({},'lang') }}"></td>
            <td class="winner_team_small"><a href="{{ path('_showteam', { 'teamid': team.id, 'groupid': team.group }) }}"><b>{{ team.name }}</b></a></td>
        {% endif %}
        </tr>
    {% endfor %}
    {% if teams|length == 0 %}
        <tr>
            <td class="winner_flag">&nbsp;</td>
            <td class="winner_team_small">&nbsp;</td>
        </tr>
    {% endif %}
    </table>
{% endmacro %}
        
{% block body %}
<h1 class="category">{{ tournament.name }}</h1>
<p class="subcategory">
    {% trans %}RESULTS{% endtrans %} {{ tournament.edition }}<br />
</p>
<div class="tab active" onclick="location.href='{{ path('_tournament_winners', {'tournament': tournament.key }) }}'">{{ 'WINNERS'|trans|upper }}</div>
<div class="tab" onclick="location.href='{{ path('_tournament_winners_countries', {'tournament': tournament.key }) }}'">{{ 'WINNING_COUNTRIES'|trans|upper }}</div>
<div class="tab" onclick="location.href='{{ path('_tournament_winners_clubs', {'tournament': tournament.key }) }}'">{{ 'WINNING_CLUBS'|trans|upper }}</div>
{% if championlist|length > 0 %}
<table>
    <caption>{% trans %}WINNERS{% endtrans %}</caption>
    <thead>
        <tr>
            <td>{% trans %}CATEGORY{% endtrans %}</td>
            <td class="winner_first winners">{% trans %}FIRST{% endtrans %}</td>
            <td class="winner_second winners">{% trans %}SECOND{% endtrans %}</td>
            <td class="winner_third winners">{% trans %}THIRD{% endtrans %}</td>
            <td class="winner_third winners">{% trans %}FORTH{% endtrans %}</td>
        </tr>
    </thead>
    <tboby>
    {% for category in championlist %}
        {% set group = category.group %}
        <tr class="{{ cycle(['even','odd'],loop.index) }}">
            <td>
                <a href="{{ path('_showcategory_finals', {'tournament': tournament.key, 'categoryid': group.catid }) }}"
                   title="{{ ['GENDER.',
                    group.gender,
                    group.class]|join|transchoice(group.age, { '%age%': group.age },'tournament') }}">
                    <b>{{ group.category }}</b>
                </a>
            </td>
            <td>{{ formatter.club(category.first, _context) }}</td>
            <td>{{ formatter.club(category.second, _context) }}</td>
            <td>{{ formatter.club(category.third, _context) }}</td>
            <td>{{ formatter.club(category.forth, _context) }}</td>
        </tr>
    {% endfor %}
    </tboby>
    <tfoot>
        <tr>
            <td colspan="5"></td>
        </tr>
    </tfoot>
</table>
{% else %}
<h2 class="category">{% trans %}NOWINNERS{% endtrans %}</h2>
{% endif %}
{% endblock %}